{
  "dashboard": {
    "title": "Error Tracking & Rate Limiting",
    "tags": ["errors", "rate-limiting", "security"],
    "timezone": "browser",
    "panels": [
      {
        "id": 1,
        "title": "Error Rate by Type",
        "type": "graph",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
        "targets": [
          {
            "expr": "sum(rate(errors_total[5m])) by (error_type, service)",
            "legendFormat": "{{service}} - {{error_type}}",
            "refId": "A"
          }
        ],
        "yaxes": [
          {"format": "reqps", "label": "Errors/sec"},
          {"format": "short"}
        ]
      },
      {
        "id": 2,
        "title": "Validation Errors",
        "type": "graph",
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0},
        "targets": [
          {
            "expr": "sum(rate(validation_errors_total[5m])) by (service, field)",
            "legendFormat": "{{service}} - {{field}}",
            "refId": "A"
          }
        ]
      },
      {
        "id": 3,
        "title": "Rate Limit Exceeded Events",
        "type": "graph",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8},
        "targets": [
          {
            "expr": "sum(rate(rate_limit_exceeded_total[5m])) by (service, endpoint)",
            "legendFormat": "{{service}} {{endpoint}}",
            "refId": "A"
          }
        ],
        "yaxes": [
          {"format": "reqps", "label": "Rate Limit Hits/sec"},
          {"format": "short"}
        ]
      },
      {
        "id": 4,
        "title": "Error Distribution (Last Hour)",
        "type": "piechart",
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 8},
        "targets": [
          {
            "expr": "sum(increase(errors_total[1h])) by (error_type)",
            "legendFormat": "{{error_type}}",
            "refId": "A"
          }
        ]
      },
      {
        "id": 5,
        "title": "Top Endpoints with Errors",
        "type": "table",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 16},
        "targets": [
          {
            "expr": "topk(10, sum(rate(http_requests_total{status=~\"5..\"}[5m])) by (service, route))",
            "legendFormat": "{{service}} {{route}}",
            "refId": "A",
            "format": "table"
          }
        ]
      },
      {
        "id": 6,
        "title": "Authentication Failures",
        "type": "graph",
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 16},
        "targets": [
          {
            "expr": "sum(rate(errors_total{error_type=\"UnauthorizedError\"}[5m])) by (service)",
            "legendFormat": "{{service}}",
            "refId": "A"
          }
        ]
      }
    ],
    "refresh": "10s",
    "time": {"from": "now-1h", "to": "now"}
  }
}
