!function(){"use strict";class t{constructor(t={}){this.config={modalId:"quick-view-modal",enableZoom:!0,enableShare:!0,enableWishlist:!0,minQuantity:1,maxQuantity:99,closeOnEscape:!0,closeOnOutsideClick:!0,enableKeyboardNav:!0,enableAnalytics:!0,animationDuration:300,...t},this.currentProduct=null,this.currentImageIndex=0,this.quantity=1,this.modal=null,this.focusTrap=null,this.init()}init(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this.setup()):this.setup()}setup(){this.createModal(),this.attachGlobalListeners(),window.QuickViewModal=this}createModal(){if(document.getElementById(this.config.modalId))return void(this.modal=document.getElementById(this.config.modalId));const t=`\n <div id="${this.config.modalId}" class="quick-view-modal" role="dialog" aria-modal="true" aria-labelledby="quick-view-title" style="display: none;">\n <div class="quick-view-overlay"></div>\n <div class="quick-view-container">\n <button class="quick-view-close" aria-label="Cerrar vista r√°pida" title="Cerrar (Esc)">\n <i class="fas fa-times"></i>\n </button>\n\n <div class="quick-view-content">\n \x3c!-- Columna Izquierda: Im√°genes --\x3e\n <div class="quick-view-gallery">\n <div class="quick-view-main-image">\n <img src="" alt="" id="quick-view-main-img" class="zoomable-image">\n <div class="quick-view-badge"></div>\n </div>\n \n <div class="quick-view-thumbnails">\n \x3c!-- Thumbnails din√°micos --\x3e\n </div>\n\n <div class="quick-view-image-nav">\n <button class="image-nav-btn prev" aria-label="Imagen anterior">\n <i class="fas fa-chevron-left"></i>\n </button>\n <button class="image-nav-btn next" aria-label="Imagen siguiente">\n <i class="fas fa-chevron-right"></i>\n </button>\n </div>\n </div>\n\n \x3c!-- Columna Derecha: Detalles --\x3e\n <div class="quick-view-details">\n <div class="quick-view-header">\n <span class="quick-view-category" id="quick-view-category"></span>\n <h2 class="quick-view-title" id="quick-view-title"></h2>\n </div>\n\n <div class="quick-view-rating">\n <div class="stars" id="quick-view-stars"></div>\n <span class="reviews-count" id="quick-view-reviews"></span>\n </div>\n\n <div class="quick-view-price-section">\n <div class="quick-view-price" id="quick-view-price"></div>\n <div class="quick-view-stock" id="quick-view-stock">\n <i class="fas fa-check-circle"></i> En stock\n </div>\n </div>\n\n <div class="quick-view-description">\n <h3>Descripci√≥n</h3>\n <p id="quick-view-description"></p>\n </div>\n\n <div class="quick-view-features" id="quick-view-features">\n \x3c!-- Features din√°micas --\x3e\n </div>\n\n <div class="quick-view-actions">\n <div class="quantity-selector">\n <button class="quantity-btn minus" aria-label="Disminuir cantidad">\n <i class="fas fa-minus"></i>\n </button>\n <input type="number" class="quantity-input" id="quick-view-quantity" value="1" min="1" max="99" aria-label="Cantidad">\n <button class="quantity-btn plus" aria-label="Aumentar cantidad">\n <i class="fas fa-plus"></i>\n </button>\n </div>\n\n <button class="btn-add-to-cart" id="quick-view-add-cart">\n <i class="fas fa-shopping-cart"></i>\n Agregar al Carrito\n </button>\n\n <button class="btn-wishlist" id="quick-view-wishlist" title="Agregar a favoritos">\n <i class="far fa-heart"></i>\n </button>\n </div>\n\n <div class="quick-view-meta">\n <div class="meta-item">\n <strong>SKU:</strong>\n <span id="quick-view-sku"></span>\n </div>\n <div class="meta-item">\n <strong>Categor√≠a:</strong>\n <span id="quick-view-meta-category"></span>\n </div>\n </div>\n\n <div class="quick-view-share" id="quick-view-share">\n <p><strong>Compartir:</strong></p>\n <div class="share-buttons">\n <button class="share-btn facebook" data-network="facebook" title="Compartir en Facebook">\n <i class="fab fa-facebook-f"></i>\n </button>\n <button class="share-btn twitter" data-network="twitter" title="Compartir en Twitter">\n <i class="fab fa-twitter"></i>\n </button>\n <button class="share-btn whatsapp" data-network="whatsapp" title="Compartir en WhatsApp">\n <i class="fab fa-whatsapp"></i>\n </button>\n <button class="share-btn copy" data-network="copy" title="Copiar enlace">\n <i class="fas fa-link"></i>\n </button>\n </div>\n </div>\n\n <a href="#" class="quick-view-full-details" id="quick-view-full-link">\n Ver detalles completos <i class="fas fa-arrow-right"></i>\n </a>\n </div>\n </div>\n </div>\n </div>\n `;document.body.insertAdjacentHTML("beforeend",t),this.modal=document.getElementById(this.config.modalId),this.attachModalListeners()}attachGlobalListeners(){document.addEventListener("click",t=>{const e=t.target.closest("[data-quick-view]");if(e){t.preventDefault();const i=parseInt(e.dataset.quickView);this.open(i)}})}attachModalListeners(){if(this.modal.querySelector(".quick-view-close").addEventListener("click",()=>this.close()),this.config.closeOnOutsideClick){this.modal.querySelector(".quick-view-overlay").addEventListener("click",()=>this.close())}this.config.closeOnEscape&&document.addEventListener("keydown",t=>{"Escape"===t.key&&this.isOpen()&&this.close()});const t=this.modal.querySelector(".image-nav-btn.prev"),e=this.modal.querySelector(".image-nav-btn.next");t.addEventListener("click",()=>this.previousImage()),e.addEventListener("click",()=>this.nextImage());const i=this.modal.querySelector(".quantity-btn.minus"),n=this.modal.querySelector(".quantity-btn.plus"),a=this.modal.querySelector("#quick-view-quantity");i.addEventListener("click",()=>this.decreaseQuantity()),n.addEventListener("click",()=>this.increaseQuantity()),a.addEventListener("change",t=>this.setQuantity(t.target.value));this.modal.querySelector("#quick-view-add-cart").addEventListener("click",()=>this.addToCart());this.modal.querySelector("#quick-view-wishlist").addEventListener("click",()=>this.toggleWishlist());this.modal.querySelectorAll(".share-btn").forEach(t=>{t.addEventListener("click",t=>{const e=t.currentTarget.dataset.network;this.share(e)})}),this.config.enableKeyboardNav&&this.modal.addEventListener("keydown",t=>this.handleKeyboard(t))}open(t){const e=this.getProduct(t);e?(this.currentProduct=e,this.currentImageIndex=0,this.quantity=1,this.renderProduct(e),this.modal.style.display="flex",document.body.style.overflow="hidden",setTimeout(()=>{this.modal.classList.add("active")},10),this.setupFocusTrap(),this.config.enableAnalytics&&window.FloresVictoriaAnalytics&&window.FloresVictoriaAnalytics.trackQuickView(t,e.name)):console.error("Producto no encontrado:",t)}close(){this.modal.classList.remove("active"),setTimeout(()=>{this.modal.style.display="none",document.body.style.overflow="",this.currentProduct=null,this.currentImageIndex=0,this.quantity=1},this.config.animationDuration),this.removeFocusTrap()}isOpen(){return"none"!==this.modal.style.display}renderProduct(t){document.getElementById("quick-view-title").textContent=t.name,document.getElementById("quick-view-category").textContent=t.category,document.getElementById("quick-view-meta-category").textContent=t.category;document.getElementById("quick-view-price").textContent=`$${t.price.toLocaleString("es-MX")}`;const e=document.getElementById("quick-view-stars"),i=t.rating||5;e.innerHTML='<i class="fas fa-star"></i>'.repeat(i)+'<i class="far fa-star"></i>'.repeat(5-i),document.getElementById("quick-view-reviews").textContent=`(${t.reviews||0} rese√±as)`,document.getElementById("quick-view-description").textContent=t.description||"Sin descripci√≥n disponible",document.getElementById("quick-view-sku").textContent=t.sku||`FV-${t.id}`;this.modal.querySelector(".quick-view-badge").textContent=t.badge||"Nuevo";const n=document.getElementById("quick-view-stock");!1===t.stock||0===t.stock?(n.innerHTML='<i class="fas fa-times-circle"></i> Agotado',n.classList.add("out-of-stock")):(n.innerHTML='<i class="fas fa-check-circle"></i> En stock',n.classList.remove("out-of-stock")),this.renderFeatures(t.features),this.renderImages(t);document.getElementById("quick-view-full-link").href=`/pages/product-detail.html?id=${t.id}`,this.updateWishlistButton(t.id)}renderFeatures(t){const e=document.getElementById("quick-view-features");if(!t||0===t.length)return void(e.style.display="none");e.style.display="block",e.innerHTML='<h3>Caracter√≠sticas</h3><ul class="features-list"></ul>';const i=e.querySelector(".features-list");t.forEach(t=>{const e=document.createElement("li");e.innerHTML=`<i class="fas fa-check"></i> ${t}`,i.appendChild(e)})}renderImages(t){const e=document.getElementById("quick-view-main-img"),i=t.images||[t.image];e.src=i[0],e.alt=t.name;const n=this.modal.querySelector(".quick-view-thumbnails");n.innerHTML="",i.length>1?i.forEach((e,i)=>{const a=document.createElement("button");a.className="thumbnail "+(0===i?"active":""),a.innerHTML=`<img src="${e}" alt="${t.name} ${i+1}">`,a.addEventListener("click",()=>this.selectImage(i)),n.appendChild(a)}):n.style.display="none",this.config.enableZoom&&this.enableImageZoom(e)}selectImage(t){if(!this.currentProduct)return;const e=this.currentProduct.images||[this.currentProduct.image];this.currentImageIndex=t;document.getElementById("quick-view-main-img").src=e[t];this.modal.querySelectorAll(".thumbnail").forEach((e,i)=>{e.classList.toggle("active",i===t)})}previousImage(){if(!this.currentProduct)return;const t=this.currentProduct.images||[this.currentProduct.image];this.currentImageIndex=(this.currentImageIndex-1+t.length)%t.length,this.selectImage(this.currentImageIndex)}nextImage(){if(!this.currentProduct)return;const t=this.currentProduct.images||[this.currentProduct.image];this.currentImageIndex=(this.currentImageIndex+1)%t.length,this.selectImage(this.currentImageIndex)}enableImageZoom(t){t.addEventListener("mousemove",e=>{const i=t.getBoundingClientRect(),n=(e.clientX-i.left)/i.width*100,a=(e.clientY-i.top)/i.height*100;t.style.transformOrigin=`${n}% ${a}%`,t.style.transform="scale(1.5)"}),t.addEventListener("mouseleave",()=>{t.style.transform="scale(1)"})}increaseQuantity(){this.quantity<this.config.maxQuantity&&(this.quantity++,this.updateQuantityInput())}decreaseQuantity(){this.quantity>this.config.minQuantity&&(this.quantity--,this.updateQuantityInput())}setQuantity(t){const e=parseInt(t);e>=this.config.minQuantity&&e<=this.config.maxQuantity?this.quantity=e:e<this.config.minQuantity?this.quantity=this.config.minQuantity:this.quantity=this.config.maxQuantity,this.updateQuantityInput()}updateQuantityInput(){this.modal.querySelector("#quick-view-quantity").value=this.quantity}addToCart(){if(this.currentProduct){if("function"==typeof window.addToCart){for(let t=0;t<this.quantity;t++)window.addToCart(this.currentProduct.id);this.showNotification(`${this.currentProduct.name} (x${this.quantity}) agregado al carrito üõí`,"success")}else console.warn("Funci√≥n addToCart no disponible");this.config.enableAnalytics&&window.FloresVictoriaAnalytics&&window.FloresVictoriaAnalytics.trackAddToCart(this.currentProduct.id,this.currentProduct.name,this.quantity,"quick-view")}}toggleWishlist(){this.currentProduct&&"function"==typeof window.addToWishlist&&(window.addToWishlist(this.currentProduct.id),this.updateWishlistButton(this.currentProduct.id))}updateWishlistButton(t){const e=JSON.parse(localStorage.getItem("wishlist")||"[]").some(e=>e.id===t),i=this.modal.querySelector("#quick-view-wishlist"),n=i.querySelector("i");e?(n.className="fas fa-heart",i.classList.add("active")):(n.className="far fa-heart",i.classList.remove("active"))}share(t){if(!this.currentProduct)return;const e=encodeURIComponent(`${window.location.origin}/pages/product-detail.html?id=${this.currentProduct.id}`),i=encodeURIComponent(`¬°Mira este hermoso arreglo! ${this.currentProduct.name}`);let n="";switch(t){case"facebook":n=`https://www.facebook.com/sharer/sharer.php?u=${e}`,window.open(n,"_blank","width=600,height=400");break;case"twitter":n=`https://twitter.com/intent/tweet?url=${e}&text=${i}`,window.open(n,"_blank","width=600,height=400");break;case"whatsapp":n=`https://wa.me/?text=${i}%20${e}`,window.open(n,"_blank");break;case"copy":navigator.clipboard.writeText(decodeURIComponent(e)).then(()=>{this.showNotification("Enlace copiado al portapapeles ‚úì","success")})}this.config.enableAnalytics&&window.FloresVictoriaAnalytics&&window.FloresVictoriaAnalytics.trackShare(t,this.currentProduct.id)}getProduct(t){return window.productCatalogInstance&&window.productCatalogInstance.allProducts?window.productCatalogInstance.allProducts.find(e=>e.id===t):window.productsData?window.productsData.find(e=>e.id===t):null}handleKeyboard(t){if(this.isOpen())switch(t.key){case"ArrowLeft":this.previousImage(),t.preventDefault();break;case"ArrowRight":this.nextImage(),t.preventDefault()}}setupFocusTrap(){const t=this.modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),e=t[0],i=t[t.length-1];this.focusTrap=t=>{"Tab"===t.key&&(t.shiftKey?document.activeElement===e&&(i.focus(),t.preventDefault()):document.activeElement===i&&(e.focus(),t.preventDefault()))},this.modal.addEventListener("keydown",this.focusTrap),e?.focus()}removeFocusTrap(){this.focusTrap&&(this.modal.removeEventListener("keydown",this.focusTrap),this.focusTrap=null)}showNotification(t,e="info"){const i=document.createElement("div");i.style.cssText=`\n position: fixed;\n top: 20px;\n right: 20px;\n background: ${"success"===e?"#48bb78":"error"===e?"#dc3545":"#C2185B"};\n color: white;\n padding: 1rem 1.5rem;\n border-radius: 8px;\n box-shadow: 0 4px 12px rgba(0,0,0,0.2);\n z-index: 10000;\n font-weight: 600;\n transform: translateX(100%);\n transition: transform 0.3s ease;\n `,i.textContent=t,document.body.appendChild(i),setTimeout(()=>{i.style.transform="translateX(0)"},100),setTimeout(()=>{i.style.transform="translateX(100%)",setTimeout(()=>i.remove(),300)},3e3)}}window.QuickViewModal=t,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new t}):new t}();
//# sourceMappingURL=quick-view-modal.min.js.map