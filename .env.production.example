# ==================================================================
# CONFIGURACIÓN DE PRODUCCIÓN - FLORES VICTORIA v3.0
# Oracle Cloud Infrastructure
# ==================================================================

# ==================================================================
# ENTORNO
# ==================================================================
NODE_ENV=production
PORT=3000

# ==================================================================
# BASE DE DATOS - POSTGRESQL (Transaccionales)
# ==================================================================
# Oracle Cloud Autonomous Database o Compute Instance
POSTGRES_HOST=your-oracle-db-host.oraclecloud.com
POSTGRES_PORT=5432
POSTGRES_DB=flores_victoria_prod
POSTGRES_USER=flores_admin
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD_HERE
POSTGRES_MAX_CONNECTIONS=100
POSTGRES_IDLE_TIMEOUT=30000
POSTGRES_CONNECTION_TIMEOUT=10000

# Legacy compatibility
DB_HOST=${POSTGRES_HOST}
DB_PORT=${POSTGRES_PORT}
DB_NAME=${POSTGRES_DB}
DB_USER=${POSTGRES_USER}
DB_PASSWORD=${POSTGRES_PASSWORD}

# SSL para PostgreSQL en Oracle Cloud
POSTGRES_SSL=true
POSTGRES_SSL_CA=/path/to/oracle-ca-cert.pem

# ==================================================================
# BASE DE DATOS - MONGODB (Catálogo de Productos)
# ==================================================================
# Oracle Cloud MongoDB o MongoDB Atlas
MONGO_INITDB_ROOT_USERNAME=flores_admin
MONGO_INITDB_ROOT_PASSWORD=CHANGE_ME_MONGO_PASSWORD
MONGODB_PASSWORD=${MONGO_INITDB_ROOT_PASSWORD}
MONGODB_URI=mongodb://${MONGO_INITDB_ROOT_USERNAME}:${MONGO_INITDB_ROOT_PASSWORD}@your-mongodb-host:27017/flores_victoria_prod?authSource=admin

MONGODB_MAX_POOL_SIZE=50
MONGODB_MIN_POOL_SIZE=10

# ==================================================================
# REDIS (Cache & Rate Limiting)
# ==================================================================
# Oracle Cloud Redis o Redis Enterprise
REDIS_HOST=your-redis-host.oraclecloud.com
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}
REDIS_TLS=true
REDIS_DB=0
REDIS_RATELIMIT_DB=2
REDIS_CACHE_TTL=3600

# ==================================================================
# RABBITMQ (Message Broker)
# ==================================================================
RABBITMQ_HOST=your-rabbitmq-host.oraclecloud.com
RABBITMQ_PORT=5672
RABBITMQ_USER=flores_admin
RABBITMQ_PASSWORD=CHANGE_ME_RABBITMQ_PASSWORD
RABBITMQ_URL=amqp://${RABBITMQ_USER}:${RABBITMQ_PASSWORD}@${RABBITMQ_HOST}:${RABBITMQ_PORT}

# ==================================================================
# SEGURIDAD & AUTENTICACIÓN
# ==================================================================
JWT_SECRET=CHANGE_ME_SUPER_SECRET_JWT_KEY_MIN_64_CHARS_RECOMMENDED
JWT_EXPIRES_IN=24h
JWT_REFRESH_SECRET=CHANGE_ME_REFRESH_TOKEN_SECRET_DIFFERENT_FROM_MAIN
JWT_REFRESH_EXPIRES_IN=7d

# Bcrypt
BCRYPT_ROUNDS=12

# CORS
CORS_ORIGIN=https://floresvictoria.com,https://www.floresvictoria.com
CORS_CREDENTIALS=true

# ==================================================================
# RATE LIMITING (Producción - más restrictivo)
# ==================================================================
# Límites ajustados para producción
RATE_LIMIT_PUBLIC_MAX=100
RATE_LIMIT_PUBLIC_WINDOW=900000
RATE_LIMIT_AUTHENTICATED_MAX=1000
RATE_LIMIT_AUTHENTICATED_WINDOW=900000
RATE_LIMIT_ADMIN_MAX=5000
RATE_LIMIT_ADMIN_WINDOW=900000
RATE_LIMIT_CRITICAL_MAX=10
RATE_LIMIT_CRITICAL_WINDOW=900000
RATE_LIMIT_SEARCH_MAX=30
RATE_LIMIT_SEARCH_WINDOW=60000
RATE_LIMIT_UPLOAD_MAX=50
RATE_LIMIT_UPLOAD_WINDOW=3600000

# Whitelist de IPs (separadas por coma)
RATE_LIMIT_WHITELIST=your-admin-ip,your-ci-cd-ip

# ==================================================================
# LOGGING
# ==================================================================
LOG_LEVEL=info
LOG_DIR=/var/log/flores-victoria
ENABLE_LOG_ROTATION=true
LOG_MAX_FILES=30d
LOG_MAX_SIZE=100m

# ==================================================================
# SERVICIOS EXTERNOS
# ==================================================================
# Email (Oracle Cloud Email Delivery o SendGrid)
SMTP_HOST=smtp.oraclecloud.com
SMTP_PORT=587
SMTP_USER=your-smtp-user
SMTP_PASSWORD=CHANGE_ME_SMTP_PASSWORD
SMTP_FROM=noreply@floresvictoria.com
SMTP_TLS=true

# Notificaciones (Firebase Cloud Messaging)
FCM_SERVER_KEY=CHANGE_ME_FCM_SERVER_KEY

# Almacenamiento de imágenes (Oracle Object Storage)
OCI_TENANCY=your-tenancy-ocid
OCI_USER=your-user-ocid
OCI_FINGERPRINT=your-fingerprint
OCI_KEY_FILE=/path/to/oci_api_key.pem
OCI_BUCKET_NAME=flores-victoria-images
OCI_REGION=us-phoenix-1

# ==================================================================
# PAGOS & FACTURACIÓN
# ==================================================================
# Stripe
STRIPE_SECRET_KEY=sk_live_CHANGE_ME_STRIPE_SECRET_KEY
STRIPE_PUBLISHABLE_KEY=pk_live_CHANGE_ME_STRIPE_PUBLISHABLE_KEY
STRIPE_WEBHOOK_SECRET=whsec_CHANGE_ME_WEBHOOK_SECRET

# Mercado Pago (opcional)
MERCADOPAGO_ACCESS_TOKEN=CHANGE_ME_MP_ACCESS_TOKEN

# ==================================================================
# MONITOREO & OBSERVABILIDAD
# ==================================================================
# Sentry (error tracking)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# New Relic (APM)
NEW_RELIC_LICENSE_KEY=CHANGE_ME_NEW_RELIC_LICENSE
NEW_RELIC_APP_NAME=Flores-Victoria-Production

# Jaeger (distributed tracing)
JAEGER_AGENT_HOST=your-jaeger-host.oraclecloud.com
JAEGER_DISABLED=false

# Prometheus
PROMETHEUS_PORT=9090
ENABLE_METRICS=true

# ==================================================================
# HEALTH CHECKS
# ==================================================================
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000

# ==================================================================
# MICROSERVICIOS - PUERTOS & HOSTS
# ==================================================================
# Puertos internos
API_GATEWAY_PORT=3000
AUTH_SERVICE_PORT=3001
PRODUCT_SERVICE_PORT=3002
USER_SERVICE_PORT=3003
ORDER_SERVICE_PORT=3004
CART_SERVICE_PORT=3005
WISHLIST_SERVICE_PORT=3006
REVIEW_SERVICE_PORT=3007
CONTACT_SERVICE_PORT=3008
NOTIFICATION_SERVICE_PORT=3009

# Hosts internos (Oracle Cloud Compute Instances o Kubernetes Services)
AUTH_SERVICE_URL=https://auth.floresvictoria.internal:${AUTH_SERVICE_PORT}
USER_SERVICE_URL=https://users.floresvictoria.internal:${USER_SERVICE_PORT}
PRODUCT_SERVICE_URL=https://products.floresvictoria.internal:${PRODUCT_SERVICE_PORT}
ORDER_SERVICE_URL=https://orders.floresvictoria.internal:${ORDER_SERVICE_PORT}
CART_SERVICE_URL=https://cart.floresvictoria.internal:${CART_SERVICE_PORT}
WISHLIST_SERVICE_URL=https://wishlist.floresvictoria.internal:${WISHLIST_SERVICE_PORT}
REVIEW_SERVICE_URL=https://reviews.floresvictoria.internal:${REVIEW_SERVICE_PORT}
CONTACT_SERVICE_URL=https://contact.floresvictoria.internal:${CONTACT_SERVICE_PORT}
NOTIFICATION_SERVICE_URL=https://notifications.floresvictoria.internal:${NOTIFICATION_SERVICE_PORT}

# ==================================================================
# CDN & ASSETS
# ==================================================================
CDN_URL=https://cdn.floresvictoria.com
STATIC_ASSETS_URL=https://assets.floresvictoria.com

# ==================================================================
# FRONTEND
# ==================================================================
FRONTEND_URL=https://www.floresvictoria.com
ADMIN_PANEL_URL=https://admin.floresvictoria.com

# ==================================================================
# BACKUP & DISASTER RECOVERY
# ==================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_PATH=/backups/flores-victoria

# ==================================================================
# LÍMITES & TIMEOUTS
# ==================================================================
REQUEST_TIMEOUT=30000
MAX_REQUEST_SIZE=10mb
MAX_FILE_SIZE=5mb

# ==================================================================
# FEATURES FLAGS
# ==================================================================
ENABLE_AI_IMAGES=true
ENABLE_REVIEWS=true
ENABLE_WISHLIST=true
ENABLE_NOTIFICATIONS=true
ENABLE_ANALYTICS=true

# ==================================================================
# CACHE CONFIGURATION
# ==================================================================
CACHE_PRODUCTS_TTL=3600
CACHE_CATEGORIES_TTL=7200
CACHE_USER_SESSION_TTL=86400

# ==================================================================
# AI IMAGE GENERATION (Opcional)
# ==================================================================
LEONARDO_API_KEY=CHANGE_ME_LEONARDO_API_KEY
HF_TOKEN=CHANGE_ME_HUGGING_FACE_TOKEN
AI_HORDE_API_KEY=CHANGE_ME_AI_HORDE_API_KEY

# ==================================================================
# NOTAS DE SEGURIDAD
# ==================================================================
# 1. NUNCA commitear este archivo con valores reales
# 2. Usar Oracle Cloud Secrets Management o HashiCorp Vault
# 3. Rotar credenciales cada 90 días
# 4. Auditar accesos regularmente
# 5. Habilitar MFA en todas las cuentas críticas
# 6. Usar HTTPS/TLS 1.3 en todos los endpoints
# 7. Implementar Web Application Firewall (WAF)
# 8. Configurar alertas de seguridad
# 9. Mantener logs de auditoría por 1 año mínimo
# 10. Realizar pentesting cada 6 meses

# ==================================================================
# CHECKLIST DE DEPLOYMENT
# ==================================================================
# [ ] Cambiar TODOS los CHANGE_ME por valores reales
# [ ] Configurar SSL/TLS certificates
# [ ] Configurar DNS records
# [ ] Configurar firewall rules en Oracle Cloud
# [ ] Configurar backups automáticos
# [ ] Configurar monitoring y alerting
# [ ] Realizar load testing
# [ ] Configurar CI/CD pipeline
# [ ] Documentar procedimientos de rollback
# [ ] Preparar plan de disaster recovery
# [ ] Configurar Oracle Cloud Secrets
# [ ] Habilitar Oracle Cloud WAF
# [ ] Configurar Oracle Cloud Load Balancer
# [ ] Implementar Auto Scaling
# [ ] Configurar DDoS protection
