# Nixpacks configuration for auth-service
# This file works when Root Directory is set to 'microservices/auth-service'
[phases.setup]
nixPkgs = ['nodejs']

[phases.install]
cmds = [
  # Install shared module dependencies from parent directory
  'cd ../shared && npm install --production',
  # Install auth-service dependencies in current directory
  'npm ci',
  # Copy shared module into auth-service node_modules
  'mkdir -p node_modules/@flores-victoria',
  'cp -r ../shared node_modules/@flores-victoria/'
]

[start]
cmd = 'node src/server.js'
