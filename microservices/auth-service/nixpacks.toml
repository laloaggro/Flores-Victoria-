[providers]
node = { directory = 'auth-service' }

[phases.setup]
nixPkgs = ['nodejs', 'curl']

[phases.install]
cmds = [
  'cd auth-service && rm -rf node_modules package-lock.json',
  'cd auth-service && npm install --omit=dev --no-audit --no-fund --prefer-online',
  'cd auth-service && mkdir -p node_modules/@flores-victoria',
  'cd auth-service && cp -r ../shared node_modules/@flores-victoria/',
  'cd auth-service/node_modules/@flores-victoria/shared && npm install --omit=dev --no-audit --no-fund --prefer-online'
]

[start]
cmd = 'cd auth-service && node src/server.js'
